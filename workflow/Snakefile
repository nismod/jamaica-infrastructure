configfile: "config.json"

# assign globals to these paths, they're used frequently
RAW = config["paths"]["incoming_data"]
DATA = config["paths"]["data"]
OUTPUT = config["paths"]["output"]  # We use a wildcard for this instead

wildcard_constraints:
    hazard="[^_/]+",  # no slash or underscore
    gpkg="[^/]+",  # no slash in filename
    protection_type="[^/]+",  # no slash
    layer="(nodes|edges|areas)",
    threshold="\d+(p\d+)?",
    output_path=f"{OUTPUT}(/.+[^/])?"

# container: "docker://nismod/jamaica-infrastructure"
# container: "docker://geo-test"

include: "damage.smk"
include: "adaptation.smk"
# include: "direct_damages.smk"
# include: "losses.smk"
# include: "transport_model.smk"
# include: "hotspots.smk"

from check_targets import EXPOSURE, DAMAGES, LOSSES, EAD_EAEL, TARGETS

rule all_exposure:
    input: EXPOSURE

rule all_damages:
    input: DAMAGES

rule all_losses:
    input: LOSSES

rule all_ead_eael:
    input: EAD_EAEL

rule all_targets:
    input: TARGETS
